{% extends "clients/base.html" %}

{% block title %}{{ client.name }} - PROVESI SAS{% endblock %}
{% block header_title %}Detalle del Cliente{% endblock %}

{% block back_link %}
<a href="{% url 'client-list' %}" class="back-link">â† Volver a la lista</a>
{% endblock %}

{% block content %}
<!-- InformaciÃ³n del cliente -->
<div class="info-card">
    <h3>ğŸ‘¤ {{ client.name }}</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
        <div>
            <p><strong>ğŸ“§ Email:</strong></p>
            <p>{{ client.email }}</p>
        </div>
        <div>
            <p><strong>ğŸ“± TelÃ©fono:</strong></p>
            <p>{{ client.phone|default:"No registrado" }}</p>
        </div>
        <div>
            <p><strong>ğŸ“ DirecciÃ³n:</strong></p>
            <p>{{ client.address|default:"No registrada" }}</p>
        </div>
        <div>
            <p><strong>ğŸ“… Registrado:</strong></p>
            <p class="timestamp">{{ client.created_at|date:"d/m/Y H:i" }}</p>
        </div>
    </div>
    
    <div class="btn-group" style="margin-top: 1.5rem;">
        <a href="{% url 'client-edit' client.id %}" class="btn btn-primary">âœï¸ Editar</a>
        <a href="{% url 'client-delete' client.id %}" class="btn btn-danger">ğŸ—‘ï¸ Eliminar</a>
    </div>
</div>

<!-- Ã“rdenes del cliente -->
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
    <h3 style="color: #667eea;">ğŸ“¦ Ã“rdenes Asociadas ({{ orders|length }})</h3>
    <a href="{% url 'order-create' %}" class="btn btn-success">+ Nueva Orden</a>
</div>

{% if orders %}
    <table>
        <thead>
            <tr>
                <th>CÃ³digo</th>
                <th>Estado</th>
                <th>Fecha CreaciÃ³n</th>
                <th>Ãšltima ActualizaciÃ³n</th>
            </tr>
        </thead>
        <tbody>
            {% for order in orders %}
            <tr>
                <td data-label="CÃ³digo">
                    <a href="{% url 'order-edit' order.order_number %}" style="color: #667eea; text-decoration: none; font-weight: 500;">
                        {{ order.order_number }}
                    </a>
                </td>
                <td data-label="Estado">
                    <span class="status-badge status-{{ order.status }}">
                        {{ order.get_status_display }}
                    </span>
                </td>
                <td data-label="CreaciÃ³n" class="timestamp">
                    {{ order.created_at }}
                </td>
                <td data-label="ActualizaciÃ³n" class="timestamp">
                    {{ order.updated_at }}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <div class="empty-state" style="background: #f8f9fa; border-radius: 12px;">
        <p>Este cliente no tiene Ã³rdenes asociadas.</p>
        <a href="{% url 'order-create' %}" class="btn btn-success">Crear primera orden</a>
    </div>
{% endif %}
{% endblock %}